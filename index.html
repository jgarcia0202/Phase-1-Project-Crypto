<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="style.css" />
    <title>Crypto Finder</title>
  </head>
  <body>
    <h1>WELCOME TO BITCOIN INFO WATCHER!<span>&#x1F4B8;</span></h1>
    <div id = box>
     <h2>BITCOIN<br />(BTC):</h2>
    
     <p3>See How Bitcoin Is Doing In The Market!!!!</p3>

     <p>
      Day of the Week: <span id = 'day'></span><br />
      Current Time(Eastern Time): <span id = 'time'></span>
     </p>
     <p2>
      Price in USD: <span id = 'usd'></span><br />
      Market Cap: <span id = 'chg'></span> <br />
      Change %: <span id = 'cap'></span>
     </p2>
     <footer>
       <ul>
        <p>How is the cryto market looking?</p>
         <button onclick = "function1()">Bullish!! <span >&#x21E7;</span></button>
         <button onclick = "function2()">Bearish!<span >&#x21E9;</span></button>
         <p id="system"></p>
         <form action="/form/submit" method="post">
          <label for="text">Explain why you think the market is going that way:</label>
          <br>
          <textarea id="text" name="text" rows="3" cols="50"></textarea>
          <br/>
          <input type="submit" value="Submit">
        </form>

       </ul>
     </footer>
    </div>
    <script>
    const cryptoUrl = 'https://api.coinlore.net/api/tickers/?start=0&limit=1';
    const timeUrl = 'http://worldclockapi.com/api/json/est/now'

    function function1() {
        document.getElementById("system").innerHTML = "You have voted...</br> It seems that you believe that the crypto market is looking Bullish! That means that the market is going up!!!";
      }
      function function2() {
        document.getElementById("system").innerHTML = "You have voted...</br> It seems that you believe that the crypto market is looking Bearish! That means that the market is going down!!!";
      }
    async function getCryto() {
      const response = await fetch(cryptoUrl);
      const dat = await response.json();
      const priceUSD = dat.data[0].price_usd;
      const changeUSD = dat.data[0].percent_change_24h;
      const capUSD = dat.data[0].market_cap_usd;
      console.log(dat.data[0].price_usd);
      console.log(dat.data[0].percent_change_24h);
      console.log(dat.data[0].market_cap_usd);

      document.getElementById('usd').textContent = priceUSD;
      document.getElementById('cap').textContent = changeUSD;
      document.getElementById('chg').textContent = capUSD;
    }
    

    async function getTime() {
      const response = await fetch(timeUrl);
      const data = await response.json();
      const { currentDateTime, dayOfTheWeek} = data;
      console.log(currentDateTime);
      console.log(dayOfTheWeek);
      // timeZoneName: "Eastern Standard Time"
      document.getElementById('day').textContent = dayOfTheWeek;
      document.getElementById('time').textContent = currentDateTime;
    }

    getCryto();
    getTime();
    </script>
    <script> src="script.js"</script>
  </body>
</html>